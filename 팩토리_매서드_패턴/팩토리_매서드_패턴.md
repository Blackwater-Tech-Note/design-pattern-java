## íŒ©í† ë¦¬ ë©”ì„œë“œê°€ ë¬´ì—‡ì¸ê°€? ğŸ¤”
>ë¶€ëª¨ í´ë˜ìŠ¤ì—ì„œ ê°ì²´ë“¤ì„ ìƒì„±í•  ìˆ˜ ìˆëŠ” ì¸í„°í˜ì´ìŠ¤ë¥¼ ì œê³µí•˜ì§€ë§Œ, ìì‹ í´ë˜ìŠ¤ë“¤ì´ ìƒì„±ë  ê°ì²´ë“¤ì˜ ìœ í˜•ì„ ë³€ê²½í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ìƒì„±Â íŒ¨í„´
![image](https://github.com/Blackwater-Tech-Note/design-pattern-java/assets/108210958/66abe056-0188-4097-997d-c5de3e10b68a)
ì´ íŒ©í† ë¦¬ ë©”ì„œë“œê°€ ìŠ¤í”„ë§ì—ì„œ ì–´ë–»ê²Œ ì‚¬ìš©ë ê¹Œìš”? 
ìŠ¤í”„ë§ì—ì„œ ë¹ˆì„ ë“±ë¡í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ì„œ ì‚´í´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.


## ìŠ¤í”„ë§ì—ì„œ ë¹ˆì„ ë“±ë¡í•˜ëŠ” ë°©ë²•ì— ëŒ€í•˜ì—¬

ìŠ¤í”„ë§ì—ì„œëŠ” ë¹ˆì„ ë“±ë¡í•  ë•Œ ë‘ ê°€ì§€ ë°©ë²•ì´ ìˆìŠµë‹ˆë‹¤.

í•˜ë‚˜ëŠ” ì•„ë§ˆë„ ì—¬ëŸ¬ë¶„ ëª¨ë‘ê°€ ì•Œê³  ìˆëŠ” ë°©ë²•ì¼ ê²ƒì…ë‹ˆë‹¤.

- @Componentë‚˜ @Configuration, @Beanì„ í†µí•´ì„œ ë¹ˆì„ ìƒì„±í•˜ëŠ” ê²ƒ

ë‚˜ë¨¸ì§€ í•˜ë‚˜ëŠ” ì•„ë§ˆë„ ë“¤ì–´ë³´ì…¨ì„ì§€ ëª¨ë¥´ê² ìŠµë‹ˆë‹¤.

- FactoryBeanì„ êµ¬í˜„í•´ì„œ ë§Œë“œëŠ” ê²ƒ

ê·¸ëŸ¬ë©´ ì´ ì˜ë¬¸ì´ ë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

FactoryBeanì€ ì–¸ì œ ì‚¬ìš©í•˜ê³ 

ì´ê²Œ ë¬´ì—‡ì´ëƒ? ì´ê²Œ í™í† ë¦¬ ë©”ì„œë“œ íŒ¨í„´ê³¼ ì–´ë–¤ ê´€ë ¨ì´ ìˆëŠ”ê°€?

## FactoryBeanì€ ì–¸ì œ ì‚¬ìš©í•˜ê³ ì´ê²Œ í™í† ë¦¬ ë©”ì„œë“œ íŒ¨í„´ê³¼ ì–´ë–¤ ê´€ë ¨ì´ ìˆëŠ”ê°€?
```java
public interface FactoryBean<T> {
  
	String OBJECT_TYPE_ATTRIBUTE = "factoryBeanObjectType";
  
	@Nullable
	T getObject() throws Exception;

	@Nullable
	Class<?> getObjectType();

	default boolean isSingleton() {
		return true;
	}

}
```
### ì–¸ì œ ì‚¬ìš©ë ê¹Œ?
- í´ë˜ìŠ¤ ì •ë³´ë¥¼ ë¯¸ë¦¬ ì•Œì•„ë‚¼ ìˆ˜ ì—†ëŠ” ê²½ìš°
   - ì¦‰, ë””í´íŠ¸ ìƒì„±ìë¥¼ ì´ìš©í•˜ì—¬ í´ë˜ìŠ¤ ì´ë¦„ì„ ë¯¸ë¦¬ ì•Œ ìˆ˜ ì—†ì„ ë•Œ
   - Proxyë¼ëŠ” í´ë˜ìŠ¤ì˜ newProxyInstance()ë¼ëŠ” ë©”ì†Œë“œë¥¼ í†µí•´ ë‹¤ì´ë‚˜ë¯¹ í”„ë¡ì‹œ ì˜¤ë¸Œì íŠ¸ë¥¼ ë§Œë“¤ ìˆ˜ ìˆëŠ”ë°, ë‹¤ì´ë‚˜ë¯¹ í”„ë¡ì‹œ ì˜¤ë¸Œì íŠ¸ì˜ í´ë˜ìŠ¤ëŠ” ë¬´ì—‡ì¸ì§€ ë¯¸ë¦¬ ì•Œ ìˆ˜ ì—†ë‹¤. í´ë˜ìŠ¤ ìì²´ë„ ë‚´ë¶€ì ìœ¼ë¡œ ë‹¤ì´ë‚˜ë¯¹í•˜ê²Œ ìƒˆë¡œ ì •ì˜í•´ì„œ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì´ë‹¤. ë”°ë¼ì„œ ì‚¬ì „ì— í”„ë¡ì‹œ ì˜¤ë¸Œì íŠ¸ì˜ í´ë˜ìŠ¤ ì •ë³´ë¥¼ ë¯¸ë¦¬ ì•Œì•„ë‚´ ìŠ¤í”„ë§ ë¹ˆì— ì •ì˜í•  ë°©ë²•ì´ ì—†ë‹¤.

- private ìƒì„±ìë¥¼ ì‚¬ìš©í•œ ê²½ìš°
  -  ê°•ì œì ìœ¼ë¡œ Reflectionì„ ì´ìš©í•˜ì—¬ ë¹ˆìœ¼ë¡œ ë“±ë¡í•  ìˆ˜ ìˆì§€ë§Œ
  - ì¼ë°˜ì ìœ¼ë¡œ private ìƒì„±ìë¥¼ ê°€ì§„ í´ë˜ìŠ¤ë¥¼ ë¹ˆìœ¼ë¡œ ë“±ë¡í•˜ëŠ” ì¼ì€ ê¶Œì¥ë˜ì§€ ì•ŠëŠ”ë‹¤ê³  í•œë‹¤?! ( ê·¼ë° ë‚˜ ì½”ë“œë¦¬ë·°ë¡œ ìƒì„±ì privateìœ¼ë¡œ ë§‰ìœ¼ë¼ê³  í–ˆëŠ”ë°?)

###   ë‹¤ì´ë‚˜ë¯¹ í”„ë¡ì‹œ ì˜¤ë¸Œì íŠ¸ì˜ í´ë˜ìŠ¤ëŠ” ë¬´ì—‡ì¸ì§€ ë¯¸ë¦¬ ì•Œ ìˆ˜ ì—†ë‹¤?
![image](https://github.com/Blackwater-Tech-Note/design-pattern-java/assets/108210958/a09697d8-9e80-4d79-929b-2b13fd878716)
Target
```java
public class OrderServiceImp implements OrderService {
  @Override
  public Long save(final Order order) {
      System.out.println("ì •ìƒ ì €ì¥");
      return 1L;
  }
  
  @Override
  public void getOne(final Long orderId) {
     System.out.println("ì£¼ë¬¸ í•œ ê°œ ì¡°íšŒ");
  }
}
```
Invocation Handler
```java
public class LoggingHandler implements InvocationHandler {
  private final Object target;
  private static final Logger log = LoggerFactory.getLogger(LoggingHandler.class);
  
  public LoggingHandler(Object target) {
     this.target = target;
  }
  
  @Override
  public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {
    if(method.getName().startWith("get")) {
       log.info("Excuting {} method: {} ", method.getName(), "ì¡°íšŒ ë©”ì„œë“œ í˜¸ì¶œ");
    }
  return method.invoke(target, args);
  }
}
```
JDK Dynamic Proxy
```java
class ProxyTest {
   
  @Test
  void jdkProxy{
  
 OrderService orderService = (OrderService) Proxy.newProxyInstance( ProxyTest.class.getClassLoader(),      // ClassLoader
                                     ,new Class[] {OderService.class}  //íƒ€í‚· ì¸í„°í˜ì´ìŠ¤
                                     ,new LoggingHandler(new OrderServiceImpl())
                                  );
    
    OrderService.getOne(1L);
  }
}
```
í•˜ì§€ë§Œ JDK ë‹¤ì´ë‚´ë¯¹ í”„ë¡ì‹œëŠ” ì¼ë°˜ì ì¸ ë°©ë²•ìœ¼ë¡œ Springì˜ Beanìœ¼ë¡œ ë“±ë¡í•  ìˆ˜ ì—†ë‹¤. </br>
Spring Beanì€ ê¸°ë³¸ì ìœ¼ë¡œ í´ë˜ìŠ¤ ì´ë¦„ê³¼ í”„ë¡œí¼í‹°ë¡œ ì •ì˜ë˜ì–´ ìˆê³ , </br>
Bean ì •ì˜ì—ì„œ ì§€ì •ëœ í´ë˜ìŠ¤ ì´ë¦„ê³¼ ë¦¬í”Œë ‰ì…˜ APIì˜ Class.forName("...").newInstance();ë¥¼ í™œìš©í•˜ì—¬ </br>
ë‚´ë¶€ì ì¸ ë¡œì§ì„ í†µí•´ Beanì„ ìƒì„±í•´ì¤€ë‹¤. í•˜ì§€ë§Œ JDK ë‹¤ì´ë‚´ë¯¹ í”„ë¡ì‹œëŠ” ì§€ì •ëœ í˜¸ì¶œ ì‹œì ì— ë™ì ìœ¼ë¡œ í”„ë¡ì‹œ í´ë˜ìŠ¤ë¥¼ ê°ì²´í•´ì£¼ê¸° ë•Œë¬¸ì— </br>
ì‚¬ì „ì— í”„ë¡ì‹œ ê°ì²´ì˜ ì •ë³´ë¥¼ ë¯¸ë¦¬ ì•Œ ìˆ˜ ì—†ë‹¤. </br>

## ê·¸ë ‡ë‹¤ë©´ FactoryBeanì„ ì´ìš©í•˜ì-> ë¹ˆìœ¼ë¡œ ë“±ë¡ + ëŸ°íƒ€ì„ ë•Œ ë™ì 
```java
public interface FactoryBean<T> {
    T getObject() throws Exception;  â†’ Bean ê°ì²´ë¥¼ ìƒì„±í•˜ê³  ë°˜í™˜
    Class<?> getObjectType();  â†’ FactoryBeanì— ì˜í•´ ìƒì„±ëœ ê°ì²´ì˜ Type
    default boolean isSingleton() {return true;}   â†’ getObject()ì˜ ë°˜í™˜ëœ ê°ì²´ì˜ ì‹±ê¸€í†¤ ì—¬ë¶€
}
```
```java
@Setter
public class MonitorFactoryBean implements FactoryBean<Object>{
    private Class<?> interfaces;
    private Object   target;

    @Override
    public Object getObject() throws Exception {
        return Proxy.newProxyInstance(getClass().getClassLoader()
                                    , new Class[] {interfaces}
                                    , new MonitorHandler(target));
    }
    ...
}
```
```java
@Configurable
public class MyBeanConfig {
    @Bean
    public MonitorFactoryBean monitorFactoryBean () {
        MonitorFactoryBean factory = new MonitorFactoryBean();
        factory.setInterfaces(Business.class);
        factory.setTarget(new MemberBusiness());
        return factory;
    }
}
```
```java
@Configurable
public class MyBeanConfig {
    @Bean
    public MonitorFactoryBean monitorFactoryBean () {
        MonitorFactoryBean factory = new MonitorFactoryBean();
        factory.setInterfaces(Business.class);
        factory.setTarget(new MemberBusiness());
        return factory;
    }
}
```
@Configurable ì–´ë…¸í…Œì´ì…˜ì€ í´ë˜ìŠ¤ë¥¼ í†µí•´ Beanì„ êµ¬í˜„í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ëŠ” ì–´ë…¸í…Œì´ì…˜ì´ë‹¤.</br>
ì´ ì–´ë…¸í…Œì´ì…˜ì„ í™œìš©í•˜ì—¬ ë‹¤ìŒê³¼ ê°™ì´ FactoryBeanì„ Beanìœ¼ë¡œ ë“±ë¡ì„ ì‹œì¼œì£¼ë©´ getObject() ë©”ì†Œë“œì—ì„œ ë°˜í™˜ë˜ëŠ” ë™ì ì¸ í”„ë¡ì‹œ Beanì´ ìë™ìœ¼ë¡œ Springì—ì„œ Beanìœ¼ë¡œ ì¸ì‹ëœë‹¤.</br>
